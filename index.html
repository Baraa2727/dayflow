<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TripFlow – Smarte Tagesrouten</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            ink: '#0A0A0A',
            line: '#EAEAEA'
          },
          boxShadow: {
            card: '0 6px 24px rgba(0,0,0,0.06)'
          }
        }
      }
    }
  </script>

  <!-- Markdown Parser -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- Inter Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto}
    .prose a{ text-decoration: underline; }
  </style>
</head>
<body class="bg-white text-ink">
  <!-- Header (nur Logo + Name) -->
  <header class="border-b border-line">
    <div class="mx-auto max-w-5xl px-5 h-14 flex items-center gap-3">
      <!-- Runder Logo-Button -->
      <div class="relative h-9 w-9 shrink-0 rounded-full ring-1 ring-black/10 overflow-hidden bg-black">
        <!-- Lege die Datei unter /public/logo.png (siehe Hinweis unten) -->
        <img src="logo.png" alt="TripFlow Logo" class="h-full w-full object-cover" />
      </div>
      <span class="text-sm font-semibold tracking-tight">TripFlow</span>
    </div>
  </header>

  <!-- Hero (kompakt) -->
  <section class="border-b border-line">
    <div class="mx-auto max-w-5xl px-5 py-10 md:py-14">
      <h1 class="text-3xl md:text-5xl font-semibold leading-tight">
        Smarte Tagesrouten – klar, klickbar, ready.
      </h1>
      <p class="mt-3 text-neutral-600 max-w-2xl">
        A–G Stopps mit Essen & Spaziergängen, einzeiliger Google-Maps-Routenlink, Bilder pro Stopp.
      </p>
    </div>
  </section>

  <!-- App: Eingabe + Ausgabe -->
  <main>
    <div class="mx-auto max-w-5xl px-5 py-10">
      <div class="grid md:grid-cols-5 gap-6">
        <!-- Eingabe -->
        <section class="md:col-span-2 rounded-xl border border-line bg-white shadow-card p-5">
          <h2 class="text-base font-semibold">Wunsch</h2>
          <form id="f" class="mt-4 flex flex-col gap-3">
            <input
              id="prompt"
              class="rounded-lg border border-line px-3.5 py-2.5 text-[15px] outline-none focus:ring-2 focus:ring-neutral-900/10"
              placeholder="z. B. 1 Tag in Wuppertal – entspannt & vegetarisch"
            />
            <button type="submit" class="rounded-lg bg-ink text-white px-4 py-2.5 text-sm font-medium hover:bg-black">
              Plan generieren
            </button>
          </form>
        </section>

        <!-- Ausgabe -->
        <section class="md:col-span-3 rounded-xl border border-line bg-white shadow-card p-5">
          <h3 class="text-base font-semibold">Ausgabe</h3>
          <div id="out" class="prose max-w-none mt-3">
            <p class="text-neutral-500">⬅️ Wunsch eingeben und „Plan generieren“ klicken.</p>
          </div>
        </section>
      </div>
    </div>
  </main>

  <footer class="border-t border-line">
    <div class="mx-auto max-w-5xl px-5 py-10 text-center text-sm text-neutral-500">
      © <span id="y"></span> TripFlow
    </div>
  </footer>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    const form = document.getElementById('f');
    const outEl = document.getElementById('out');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const userMessage = document.getElementById('prompt').value.trim();
      if (!userMessage) return;

      outEl.innerHTML = '<p class="text-neutral-500">⏳ Erzeuge Plan …</p>';
      try {
        const res = await fetch('/api/generate', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ userMessage }) // <- erwartet die API
        });

        const data = await res.json();
        if (res.ok && data.output) {
          outEl.innerHTML = marked.parse(data.output);
        } else {
          outEl.innerHTML = `<p class="text-red-600">Fehler: ${data.error || 'unbekannt'}</p>`;
        }
      } catch (err) {
        outEl.innerHTML = `<p class="text-red-600">Fehler beim Abruf.</p>`;
      }
    });
  </script>
</body>
</html>
