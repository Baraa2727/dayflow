<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TripFlow – Smarte Tagesrouten</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Markdown Parser -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    body { font-family: Inter, ui-sans-serif, -apple-system, Segoe UI, Roboto, system-ui; }
    .prose a { text-decoration: underline; }
  </style>
</head>
<body class="bg-white text-black">
  <!-- Header -->
  <header class="border-b border-neutral-200">
    <div class="mx-auto max-w-5xl px-5 h-14 flex items-center gap-3">
      <!-- Logo: liegt in /public/logo.png  -> im HTML als /logo.png referenzieren -->
      <div class="h-9 w-9 rounded-full overflow-hidden ring-1 ring-black/10 bg-black">
        <img src="/logo.png" alt="TripFlow Logo" class="h-full w-full object-cover" />
      </div>
      <span class="text-sm font-semibold tracking-tight">TripFlow</span>
    </div>
  </header>

  <!-- Main -->
  <main class="mx-auto max-w-5xl px-5 py-10">
    <h1 class="text-3xl md:text-5xl font-semibold leading-tight mb-6">Smarte Tagesrouten – klar, klickbar, ready.</h1>

    <div class="grid md:grid-cols-5 gap-6">
      <!-- Eingabe -->
      <section class="md:col-span-2 rounded-xl border border-neutral-200 bg-white shadow-sm p-5">
        <h2 class="text-base font-semibold">Wunsch</h2>
        <form id="f" class="mt-4 flex flex-col gap-3">
          <input
            id="prompt"
            class="rounded-lg border border-neutral-200 px-3.5 py-2.5 text-[15px] outline-none focus:ring-2 focus:ring-neutral-900/10"
            placeholder="z. B. 1 Tag in Wuppertal – entspannt & vegetarisch"
          />
          <button type="submit" class="rounded-lg bg-black text-white px-4 py-2.5 text-sm font-medium hover:bg-neutral-900">
            Plan generieren
          </button>
        </form>
      </section>

      <!-- Ausgabe -->
      <section class="md:col-span-3 rounded-xl border border-neutral-200 bg-white shadow-sm p-5">
        <h3 class="text-base font-semibold">Ausgabe</h3>
        <div id="out" class="prose max-w-none mt-3">
          <p class="text-neutral-500">⬅️ Wunsch eingeben und „Plan generieren“ klicken.</p>
        </div>
      </section>
    </div>
  </main>

  <footer class="border-t border-neutral-200">
    <div class="mx-auto max-w-5xl px-5 py-10 text-center text-sm text-neutral-500">
      © <span id="y"></span> TripFlow
    </div>
  </footer>

  <script>
    // Jahr aktualisieren
    document.getElementById('y').textContent = new Date().getFullYear();

    const form = document.getElementById('f');
    const outEl = document.getElementById('out');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const userMessage = document.getElementById('prompt').value.trim();
      if (!userMessage) return;

      outEl.innerHTML = '<p class="text-neutral-500">⏳ Erzeuge Plan …</p>';

      try {
        const res = await fetch('/api/generate', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ userMessage }) // <- so erwartet es api/generate.js
        });

        const data = await res.json();
        if (res.ok && data.output) {
          // Falls die API Markdown zurückgibt
          outEl.innerHTML = window.marked ? marked.parse(data.output) : `<pre>${data.output}</pre>`;
        } else {
          outEl.innerHTML = `<p class="text-red-600">Fehler: ${data.error || 'unbekannt'}</p>`;
        }
      } catch (err) {
        outEl.innerHTML = `<p class="text-red-600">Fehler beim Abruf.</p>`;
      }
    });
  </script>
</body>
</html>
